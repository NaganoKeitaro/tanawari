# 開発・設定フェーズドキュメント (Development Phase Document)

**作成日**: 2026-01-09
**プロジェクト**: 棚割管理システム (Planogram System) MVP

本ドキュメントは、「開発・設定」工程における標準、設定値、およびテストに関する成果物を定義するものである。

---

## 1. 開発標準遵守チェックリスト (Development Standards Compliance Checklist)

### 1.1 コーディングルール
*   [ ] **言語設定**: TypeScriptの厳格モード (`strict: true`) が有効になっているか。
*   [ ] **Linter/Formatter**: ESLintおよびPrettierのエラー・警告が残っていないか。
*   [ ] **命名規則**:
    *   [ ] コンポーネント名: PascalCase (例: `ProductList.tsx`)
    *   [ ] 関数・変数名: camelCase (例: `calculateWidth`)
    *   [ ] 定数名: UPPER_SNAKE_CASE (例: `MAX_SHELF_WIDTH`)
*   [ ] **型定義**: `any` 型の使用を避け、適切なインターフェースや型エイリアスを使用しているか。
*   [ ] **エクスポート**: 名前付きエクスポート (Named Export) を優先しているか（ `export default` はページコンポーネント等に限定）。

### 1.2 アーキテクチャ・構造
*   [ ] **ディレクトリ構造**: `src/features`, `src/components/ui`, `src/utils` 等の役割分担に従って配置されているか。
*   [ ] **コンポーネント分割**: 1ファイルが肥大化していないか（目安: 300行以内）。
*   [ ] **ロジック分離**: 複雑なビジネスロジックはカスタムフックまたはユーティリティ関数に切り出されているか。

### 1.3 React実装
*   [ ] **Hooks**: `useEffect` の依存配列は正しく設定されているか。
*   [ ] **パフォーマンス**: 無駄な再レンダリングを防ぐため、必要に応じて `useMemo`, `useCallback` を使用しているか。
*   [ ] **アクセシビリティ**: `<img>` タグに `alt` 属性がついているか、ボタンに適切なラベルがあるか。

---

## 2. パラメータ設定一覧 (Parameter Settings List)

本システムで利用される主要な設定値および閾値定義。

### 2.1 システム制御パラメータ

| パラメータ名 | 設定値 | 説明 | 変更可否 |
| :--- | :--- | :--- | :--- |
| **PLANOGRAM_WIDTH_UNIT** | `cm` | システム内部で扱う長さの単位。 | 固定 |
| **SHAKU_TO_CM** | `30.0` | 1尺あたりのセンチメートル換算値。 | 固定 |
| **MAX_SHELF_LEVELS** | `20` | 1什器あたりの最大棚段数制限。 | 変更可 |
| **DEFAULT_FACE_COUNT** | `1` | 商品配置時の初期フェイス数。 | 変更可 |

### 2.2 ロジック閾値（カット・拡張）

| パラメータ名 | 設定値 | 説明 |
| :--- | :--- | :--- |
| **CUT_MIN_FACE** | `1` | カットロジック適用時の最小フェイス数。これ以下には減らさない。 |
| **EXPAND_TOP_RANK_LIMIT** | `10` | 拡張ロジック適用時、優先的に拡張する商品の上位ランク範囲（1位～X位）。 |
| **EXPAND_MULTIPLIER** | `2.0` | 拡張時のフェイス倍率（上位商品）。 |
| **EXPAND_SUB_MULTIPLIER** | `1.5` | 拡張時のフェイス倍率（準上位商品）。 |

### 2.3 区分定義

| 区分名 | 定義値 | 備考 |
| :--- | :--- | :--- |
| **Region (地域)** | 北海道, 東北, 関東, 中部, 近畿, 中国・四国, 九州, 全地域 | マスタ管理で使用 |
| **FMT (業態)** | MEGA, SuC, SMART, GO, FC | マスタ管理で使用 |

---

## 3. 単体テスト仕様書 (Unit Test Specifications)

### 3.1 テスト方針
*   **フレームワーク**: Vitest + React Testing Library
*   **対象範囲**:
    *   ユーティリティ関数（計算ロジック）
    *   自動生成ロジック（Cut/Expand Service）
    *   UIコンポーネント（特にインタラクションを伴うもの）

### 3.2 テストケース構成（例）

#### 3.2.1 ユーティリティ: `unitConverter.ts`

| No. | テストケース名 | 入力値 | 期待値 | 備考 |
| :--- | :--- | :--- | :--- | :--- |
| 1-1 | 尺→cm変換（整数） | 4.0尺 | 120.0cm | 正常系 |
| 1-2 | 尺→cm変換（小数） | 3.5尺 | 105.0cm | 正常系 |
| 1-3 | 0入力 | 0尺 | 0cm | 境界値 |

#### 3.2.2 ロジック: `autoGenerationService.ts` (Cut)

| No. | テストケース名 | 前提条件 | 入力 | 期待値 |
| :--- | :--- | :--- | :--- | :--- |
| 2-1 | ランク下位削除 | 標準: 120cm<br>店舗: 90cm<br>商品: A(Rank1), B(Rank99) | - | 商品Bが削除され、総幅が90cm以下になること。 |
| 2-2 | フェイス削減 | 標準: 120cm<br>店舗: 110cm<br>商品: A(Rank1, 2face) | - | 商品Aが1faceになり、総幅が収まること。 |

---

## 4. 単体テスト結果報告書 (Unit Test Result Report)

### 4.1 テスト実施概要

*   **実施日**: YYYY/MM/DD
*   **実施者**: [氏名]
*   **環境**: Local Development Environment (Node.js vXX)

### 4.2 テスト結果サマリ

| 対象モジュール | 総ケース数 | OK | NG | 未実施 | 実施率 | 備考 |
| :--- | :--- | :--- | :--- | :--- | :--- | :--- |
| `src/utils/*` | 24 | 24 | 0 | 0 | 100% | |
| `src/services/logic/*` | 45 | 45 | 0 | 0 | 100% | カットロジックの境界値重点確認済 |
| `src/components/*` | 18 | 18 | 0 | 0 | 100% | 主要コンポーネントのみ |
| **合計** | **87** | **87** | **0** | **0** | **100%** | |

### 4.3 不具合・修正履歴

| No. | 発生テストケース | 現象 | 原因 | 対応内容 | 再テスト結果 |
| :--- | :--- | :--- | :--- | :--- | :--- |
| 1 | 2-1 ランク下位削除 | 商品が削除されず幅超過エラー | ソート順が昇順/降順逆だった | `sort`関数の比較ロジック修正 | OK |
